// Sistema de tradução melhorado
const translations = {
  pt: {
    // Header
    home: 'Home',
    about: 'Sobre',
    experience: 'Experiência',
    skills: 'Habilidades',
    projects: 'Projetos',
    contact: 'Contato',

    // Hero Section
    heroSubtitle: [
      'Analista de Dados'
    ],
    heroDescription: 'Especialista em transformar dados complexos em insights estratégicos que impulsionam decisões de negócio e geram valor real para organizações.',
    viewProjects: 'Ver Projetos',
    getInTouch: 'Entre em Contato',
    scroll: 'Scroll',

    // About Section
    aboutTag: 'Sobre mim',
    aboutTitle: 'Quem sou eu',
    aboutIntro: 'Sou um entusiasta em dados apaixonado por descobrir padrões ocultos e transformar informações brutas em estratégias de negócio eficazes.',
    aboutText1: 'Sou um profissional dedicado, em constante busca por novos desafios e aprendizados, sempre focado em gerar insights que causem impacto real e sustentável. Venho me aprofundando nos estudos de Análise de Dados com Python e SQL, além de desenvolver habilidades em Analytics Engineer. Meu intuito é evoluir profissionalmente e aperfeiçoar continuamente meus conhecimentos, unindo prática e teoria para entregar resultados de excelência.',
    aboutText2: 'Minha abordagem interdisciplinar me permite conectar dados, tecnologia e negócios de forma única, sempre buscando insights que impulsionem o crescimento e a inovação.',
    yearsExperience: 'Anos de Experiência',
    completedProjects: 'Projetos Concluídos',
    technologies: 'Tecnologias',
    mainSkills: 'Principais Competências',

    // Experience Section
    experienceTag: 'Trajetória',
    experienceTitle: 'Experiência Profissional',
    experienceh3: 'Bolsista - Análise de Dados',
    experienceDescripton: 'Atuo como bolsista com foco em Análise de Dados, desenvolvendo habilidades práticas em SQL (consultas simples e intermediárias), Excel, Python (Pandas e NumPy) e Power Bi.',
    experienceCont1: 'Realizo a coleta, organização e análise de dados para apoiar a tomada de decisões estratégicas.',
    experienceCont2: 'Transformo dados brutos em insights relevantes, contribuindo com relatórios e visualizações que agregam valor ao negócio.',
    experienceCont3: 'Tenho evoluído na criação de pipelines de dados e estruturação de análises consistentes.',

    // Segunda experiência
    experienceTitleSeng: 'Bolsista Back-end - Programa Trilhas',
    experienceCompanyTrilhas: 'Inova Maranhão - SECTI-MA',
    experienceDateTrilhas: '2024',
    experienceDescriptonTrilhas: 'Especialização em desenvolvimento Back-end com Node.js através do programa Trilhas, uma iniciativa da Secretaria de Ciência, Tecnologia e Inovação do Estado do Maranhão.',
    experienceliTrilhas1: 'Desenvolvimento de APIs RESTful com Node.js e Express',
    experienceliTrilhas2: 'Integração com bancos de dados relacionais e não-relacionais',
    experienceliTrilhas3: 'Implementação de autenticação e autorização',
    experienceliTrilhas4: 'Práticas de desenvolvimento ágil e versionamento de código',

    // Education Section
    educationTag: 'Formação',
    educationTitle: 'Formação Acadêmica',
    educationDescription: 'Educação não é o aprendizado de fatos, mas o treinamento da mente para pensar.',
    educationtitle: 'Bacharelado interdisciplinar em Ciência e Tecnologia',
    educationInstitution: 'Universidade Federal do Maranhão',
    educationPeriod: '2023 - Presente | Cursando',
    educationOverview: 'Formação interdisciplinar que combina conhecimentos técnicos e científicos, preparando profissionais para atuar em diversas áreas da tecnologia e inovação.',
    educationSubjects: 'Principais disciplinas e competências:',

    // Títulos das disciplinas
    educationDataScienceTitle: 'Ciência de Dados:',
    educationAlgorithmsTitle: 'Algoritmos e Programação:',
    educationMathTitle: 'Matemática Aplicada:',
    educationSoftwareTitle: 'Engenharia de Software:',
    educationManagementTitle: 'Administração:',
    educationPhysicsTitle: 'Física e Química:',

    // Descrições das disciplinas
    educationDataScience: 'Análise estatística, Visualização de dados e machine learning',
    educationAlgorithms: 'Fundamentos da Computação e Estruturas de dados',
    educationMath: 'Álgebra Linear, Cálculo, Probabilidade e Estatística',
    educationSoftware: 'Metodologias ágeis, arquitetura de sistemas',
    educationManagement: 'Gestão de projetos, empreendedorismo e inovação',
    educationPhysics: 'Fundamentos científicos para aplicações tecnológicas',

    // Skills Section
    skillsTag: 'Tecnologias',
    skillsTitle: 'Minhas Habilidades',
    dataAnalysis: 'Análise de Dados',
    dataVisualization: 'Visualização de Dados',
    appliedStatistics: 'Estatística Aplicada',
    sql: 'SQL',
    machineLearning: 'Machine Learning',

    // Skills descriptions
    pythonLibraries: 'Pandas, NumPy, Matplotlib',
    databaseSystems: 'PostgreSQL, MySQL',
    interactiveDashboards: 'Dashboards interativos',
    chartsVisualizations: 'Gráficos e visualizações',

    // Projects Section
    projectsTag: 'Portfolio',
    projectsTitle: 'Meus Projetos',
    projectsDescription: 'Explore alguns dos meus trabalhos mais recentes em análise de dados, machine learning e desenvolvimento de soluções inovadoras.',
    all: 'Todos',
    dataAnalysisFilter: 'Análise de Dados',
    machineLearningFilter: 'Machine Learning',
    webDev: 'Desenvolvimento',
    dashboard: 'Dashboards',
    viewAllProjects: 'Ver Todos os Projetos',
    allProjectsTitle: 'Meus Projetos',
    allProjectsDescription: 'Explore minha coleção completa de projetos em análise de dados, machine learning e desenvolvimento de software.',
    backToPortfolio: 'Voltar ao Portfólio',

    // Contact Section
    contactTag: 'Contato',
    contactTitle: 'Vamos Trabalhar Juntos',
    contactDescription: 'Estou sempre aberto a novas oportunidades e projetos desafiadores. Entre em contato para discutirmos como posso ajudar sua empresa.',
    email: 'Email',
    linkedin: 'LinkedIn',
    location: 'Localização',
    locationValue: 'São Luís, Maranhão',
    name: 'Nome',
    subject: 'Assunto',
    message: 'Mensagem',
    sendMessage: 'Enviar Mensagem',
    socialNetworks: 'Redes Sociais',
    letsChat: 'Vamos conversar?',
    chatDescription: 'Estou sempre aberto a novas oportunidades e projetos desafiadores. Entre em contato!',
    sendEmail: 'Enviar Email',

    // Footer
    footerText: 'Todos os direitos reservados.',
    footerDescription: 'Analista de dados especializado em transformar informações complexas em insights estratégicos para impulsionar o crescimento dos negócios.',
    navigation: 'Navegação',
    services: 'Serviços',
    consulting: 'Consultoria',
    madeWith: 'Feito com',
    andTech: 'e tecnologia',

    // Accessibility
    lightMode: 'Ativar tema claro',
    darkMode: 'Ativar tema escuro',
    portuguese: 'Português',
    english: 'English',
    switchToEnglish: 'Mudar para Inglês',
    switchToPortuguese: 'Mudar para Português',

    // Common UI Elements
    viewProject: 'Ver Projeto',
    viewCode: 'Código',
    completed: 'Concluído',
    inProgress: 'Em Progresso',

    // Projects Data - agora com estrutura melhorada
    projectTitles: {
      unicornAnalysis: 'Análise dos Unicórnios 2022 — Setores, Países e Investidores',
      jobSalariesAnalysis: 'Análise de Salários na Área de Dados - Imersão Alura',
      jovemTechSalesModel: 'Modelo de previsão em vendas - Jovem Tech',
    },
    projectDescriptions: {
      unicornAnalysis: 'Análise de empresas que atingiram o status de unicórnio em 2022, explorando setores de atuação, países de origem, investidores envolvidos e principais tendências de mercado responsáveis pelo crescimento acelerado dessas startups.',
      jobSalariesAnalysis: 'Análise dos salários de profissionais de Data Science, investigando níveis de experiência, tipos de vínculo, cargos, conversão de remunerações para uma moeda padrão, país de residência e localização da empresa, proporção de trabalho remoto e tendências salariais.',
      jovemTechSalesModel: 'Análise de Dados no Varejo – Atuei na limpeza e organização de dados reais de vendas, análise estatística com Python (Pandas, NumPy) e geração de dados sintéticos. Estruturei o código em classes reutilizáveis, aplicando boas práticas de modularização. O trabalho resultou em insights acionáveis para apoiar decisões estratégicas no setor varejista.',
    }
  },

  en: {
    // Header
    home: 'Home',
    about: 'About',
    experience: 'Experience',
    skills: 'Skills',
    projects: 'Projects',
    contact: 'Contact',

    // Hero Section
    heroSubtitle: [
      'Data Analyst'
    ],
    heroDescription: 'Specialist in transforming complex data into strategic insights that drive business decisions and generate real value for organizations.',
    viewProjects: 'View Projects',
    getInTouch: 'Get In Touch',
    scroll: 'Scroll',

    // About Section
    aboutTag: 'About me',
    aboutTitle: 'Who I am',
    aboutIntro: 'I am a data enthusiast passionate about discovering hidden patterns and transforming raw information into effective business strategies.',
    aboutText1: 'I am a dedicated professional, constantly seeking new challenges and learning opportunities, always focused on generating insights that have real and sustainable impact. I have been deepening my studies in Data Analysis with Python and SQL, while also developing skills as an Analytics Engineer. My goal is to evolve professionally and continuously improve my knowledge, combining practice and theory to deliver excellent results.',
    aboutText2: 'My interdisciplinary approach allows me to connect data, technology and business in a unique way, always seeking insights that drive growth and innovation.',
    yearsExperience: 'Years of Experience',
    completedProjects: 'Completed Projects',
    technologies: 'Technologies',
    mainSkills: 'Main Skills',

    // Experience Section
    experienceTag: 'Journey',
    experienceTitle: 'Professional Experience',
    experienceh3: 'Data Analysis Scholarship Holder',
    experienceDescripton: 'I work as a scholarship holder focused on Data Analysis, developing practical skills in SQL (basic and intermediate queries), Excel, Python (Pandas and NumPy), and Power BI.',
    experienceCont1: 'Collect, organize and analyze data to support strategic decision-making.',
    experienceCont2: 'Transform raw data into relevant insights, contributing to reports and visualizations that add value to the business.',
    experienceCont3: 'Develop data pipelines and structure consistent analyses.',

    // Segunda experiência
    experienceTitleSeng: 'Back-end Scholarship Holder - Trilhas Program',
    experienceCompanyTrilhas: 'Inova Maranhão - SECTI-MA',
    experienceDateTrilhas: '2024',
    experienceDescriptonTrilhas: 'Specialization in Back-end Development with Node.js through the Trilhas program, an initiative of the Secretariat of Science, Technology, and Innovation of the State of Maranhão.',
    experienceliTrilhas1: 'Development of RESTful APIs with Node.js and Express',
    experienceliTrilhas2: 'Integration with relational and non-relational databases',
    experienceliTrilhas3: 'Implementation of authentication and authorization',
    experienceliTrilhas4: 'Agile development practices and code versioning',

    // Education Section
    educationTag: 'Education',
    educationTitle: 'Academic Background',
    educationDescription: 'Education is not the learning of facts, but the training of the mind to think.',
    educationtitle: 'Interdisciplinary Bachelor\'s in Science and Technology',
    educationInstitution: 'Federal University of Maranhão',
    educationPeriod: '2023 - Present | Ongoing',
    educationOverview: 'Interdisciplinary education that combines technical and scientific knowledge, preparing professionals to work in various areas of technology and innovation.',
    educationSubjects: 'Main subjects and competencies:',

    // Títulos das disciplinas
    educationDataScienceTitle: 'Data Science:',
    educationAlgorithmsTitle: 'Algorithms and Programming:',
    educationMathTitle: 'Applied Mathematics:',
    educationSoftwareTitle: 'Software Engineering:',
    educationManagementTitle: 'Management:',
    educationPhysicsTitle: 'Physics and Chemistry:',

    // Descrições das disciplinas
    educationDataScience: 'Statistical analysis, Data visualization and machine learning',
    educationAlgorithms: 'Computing fundamentals and Data structures',
    educationMath: 'Linear Algebra, Calculus, Probability and Statistics',
    educationSoftware: 'Agile methodologies, systems architecture',
    educationManagement: 'Project management, entrepreneurship and innovation',
    educationPhysics: 'Scientific fundamentals for technological applications',

    // Skills Section
    skillsTag: 'Technologies',
    skillsTitle: 'My Skills',
    dataAnalysis: 'Data Analysis',
    dataVisualization: 'Data Visualization',
    appliedStatistics: 'Applied Statistics',
    sql: 'SQL',
    machineLearning: 'Machine Learning',

    // Skills descriptions
    pythonLibraries: 'Pandas, NumPy, Matplotlib',
    databaseSystems: 'PostgreSQL, MySQL',
    interactiveDashboards: 'Interactive dashboards',
    chartsVisualizations: 'Charts and visualizations',

    // Projects Section
    projectsTag: 'Portfolio',
    projectsTitle: 'My Projects',
    projectsDescription: 'Explore some of my most recent work in data analysis, machine learning and development of innovative solutions.',
    all: 'All',
    dataAnalysisFilter: 'Data Analysis',
    machineLearningFilter: 'Machine Learning',
    webDev: 'Development',
    dashboard: 'Dashboards',
    viewAllProjects: 'View All Projects',
    allProjectsTitle: 'My Projects',
    allProjectsDescription: 'Explore my complete collection of projects in data analysis, machine learning and software development.',
    backToPortfolio: 'Back to Portfolio',

    // Contact Section
    contactTag: 'Contact',
    contactTitle: 'Let\'s Work Together',
    contactDescription: 'I am always open to new opportunities and challenging projects. Get in touch to discuss how I can help your company.',
    email: 'Email',
    linkedin: 'LinkedIn',
    location: 'Location',
    locationValue: 'São Luís, Maranhão',
    name: 'Name',
    subject: 'Subject',
    message: 'Message',
    sendMessage: 'Send Message',
    socialNetworks: 'Social Networks',
    letsChat: 'Let\'s chat?',
    chatDescription: 'I am always open to new opportunities and challenging projects. Get in touch!',
    sendEmail: 'Send Email',

    // Footer
    footerText: 'All rights reserved.',
    footerDescription: 'Data analyst specialized in transforming complex information into strategic insights to drive business growth.',
    navigation: 'Navigation',
    services: 'Services',
    consulting: 'Consulting',
    madeWith: 'Made with',
    andTech: 'and technology',

    // Accessibility
    lightMode: 'Switch to light mode',
    darkMode: 'Switch to dark mode',
    portuguese: 'Português',
    english: 'English',
    switchToEnglish: 'Switch to English',
    switchToPortuguese: 'Switch to Portuguese',

    // Common UI Elements
    viewProject: 'View Project',
    viewCode: 'Code',
    completed: 'Completed',
    inProgress: 'In Progress',

    // Projects Data
    projectTitles: {
      unicornAnalysis: '2022 Unicorn Analysis — Sectors, Countries, and Investors',
      jobSalariesAnalysis: 'Data Job Salaries Analysis - Alura Immersion',
      jovemTechSalesModel: 'Sales Forecasting Model - Jovem Tech',
    },
    projectDescriptions: {
      unicornAnalysis: 'Analysis of companies that achieved unicorn status in 2022, exploring their sectors of operation, countries of origin, involved investors, and key market trends driving the accelerated growth of these startups.',
      jobSalariesAnalysis: 'Analysis of Data Science professionals salaries, investigating levels of experience, types of employment, job titles, conversion of compensation to a standard currency, country of residence and company location, proportion of remote work, and salary trends.',
      jovemTechSalesModel: 'Retail Data Analysis – Worked on cleaning and organizing real sales data, performing statistical analysis using Python (Pandas, NumPy), and generating synthetic data. Structured the code into reusable classes, applying best practices in modularization. The work resulted in actionable insights to support strategic decision-making in the retail sector.',
    }
  }
};

// Sistema de tradução melhorado
class TranslationSystem {
  constructor() {
    this.currentLang = 'pt';
    this.supportedLangs = ['pt', 'en'];
    this.observers = [];
    this.init();
  }

  init() {
    this.setupLanguageToggle();
    this.loadSavedLanguage();
    this.setupMutationObserver();
  }

  setupLanguageToggle() {
    const langToggle = document.querySelector('.lang-toggle');
    if (langToggle) {
      langToggle.addEventListener('click', () => {
        this.toggleLanguage();
      });
    }
  }

  loadSavedLanguage() {
    const savedLang = localStorage.getItem('language');
    if (savedLang && this.supportedLangs.includes(savedLang) && savedLang !== this.currentLang) {
      this.currentLang = savedLang;
      this.translatePage();
      this.updateLanguageButton();
    } else {
      // Primeira carga - traduzir elementos que podem não ter sido traduzidos
      this.translatePage();
      this.updateLanguageButton();
    }
  }

  toggleLanguage() {
    const newLang = this.currentLang === 'pt' ? 'en' : 'pt';
    this.setLanguage(newLang);
  }

  setLanguage(lang) {
    if (!this.supportedLangs.includes(lang)) return;

    this.currentLang = lang;
    this.translatePage();
    this.updateLanguageButton();
    this.updateDocumentLanguage();
    localStorage.setItem('language', lang);

    // Reinicializar typewriter com nova linguagem
    if (window.typewriter) {
      typewriter.texts = translations[this.currentLang].heroSubtitle;
      typewriter.currentTextIndex = 0;
      typewriter.currentCharIndex = 0;
      typewriter.isDeleting = false;
    }

    // Notificar observadores
    this.notifyObservers(lang);
  }

  translatePage() {
    // Traduzir elementos com data-translate
    this.translateElements();

    // Traduzir projetos dinâmicos
    this.translateProjects();

    // Traduzir atributos de acessibilidade
    this.translateAccessibilityAttributes();

    // Traduzir botões de ação
    this.translateActionButtons();
  }

  translateElements() {
    const elements = document.querySelectorAll('[data-translate]');
    elements.forEach(element => {
      const key = element.getAttribute('data-translate');
      const translation = this.getTranslation(key);

      if (translation) {
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
          element.placeholder = translation;
        } else {
          // Para elementos com apenas texto ou spans internos
          if (element.children.length === 0) {
            element.textContent = translation;
          } else {
            // Se é um elemento com estrutura complexa, verificar se tem apenas spans ou elementos simples
            const complexChildren = Array.from(element.children).filter(child =>
              !['SPAN', 'I', 'STRONG', 'EM'].includes(child.tagName)
            );

            if (complexChildren.length === 0) {
              // Se só tem elementos de formatação, pode substituir o texto
              element.textContent = translation;
            } else {
              // Se tem estrutura complexa, atualizar apenas os nós de texto diretos
              const textNodes = this.getTextNodes(element);
              if (textNodes.length === 1) {
                textNodes[0].textContent = translation;
              }
            }
          }
        }
      }
    });
  }

  translateProjects() {
    // Traduzir projetos na página principal
    this.translateMainPageProjects();

    // Traduzir projetos na página de projetos
    this.translateProjectsPageProjects();
  }


  translateMainPageProjects() {
    const projectCards = document.querySelectorAll('.project-card');
    const projectKeys = [
      'unicornAnalysis',
      'jobSalariesAnalysis',
      'jovemTechSalesModel'
    ];

    projectCards.forEach((card, index) => {
      if (projectKeys[index]) {
        const title = card.querySelector('h3');
        const description = card.querySelector('p');

        if (title && translations[this.currentLang].projectTitles[projectKeys[index]]) {
          title.textContent = translations[this.currentLang].projectTitles[projectKeys[index]];
        }
        if (description && translations[this.currentLang].projectDescriptions[projectKeys[index]]) {
          description.textContent = translations[this.currentLang].projectDescriptions[projectKeys[index]];
        }
      }
    });
  }

  translateProjectsPageProjects() {
    // Para a página projetos.html
    const projectCards = document.querySelectorAll('.project-card');
    const projectKeys = [
      'unicornAnalysis',
      'jobSalariesAnalysis',
      'jovemTechSalesModel'
    ];

    projectCards.forEach((card, index) => {
      if (projectKeys[index]) {
        const title = card.querySelector('.project-title, h3');
        const description = card.querySelector('.project-description, p');

        if (title && translations[this.currentLang].projectTitles[projectKeys[index]]) {
          title.textContent = translations[this.currentLang].projectTitles[projectKeys[index]];
        }
        if (description && translations[this.currentLang].projectDescriptions[projectKeys[index]]) {
          description.textContent = translations[this.currentLang].projectDescriptions[projectKeys[index]];
        }
      }
    });
  }

  translateAccessibilityAttributes() {
    // Atualizar aria-labels e outros atributos de acessibilidade
    const themeToggle = document.querySelector('.theme-toggle');
    if (themeToggle) {
      const currentTheme = document.body.getAttribute('data-theme') || 'dark';
      const themeLabel = currentTheme === 'dark'
        ? this.getTranslation('lightMode')
        : this.getTranslation('darkMode');
      themeToggle.setAttribute('aria-label', themeLabel);
    }

    const langToggle = document.querySelector('.lang-toggle');
    if (langToggle) {
      const langLabel = this.currentLang === 'pt'
        ? this.getTranslation('switchToEnglish')
        : this.getTranslation('switchToPortuguese');
      langToggle.setAttribute('aria-label', langLabel);
    }
  }

  translateActionButtons() {
    // Traduzir botões "Ver Projeto" e "Código"
    const viewProjectBtns = document.querySelectorAll('.btn-project.btn-primary span');
    const viewCodeBtns = document.querySelectorAll('.btn-project.btn-secondary span');

    viewProjectBtns.forEach(btn => {
      if (btn.textContent.includes('Ver Projeto') || btn.textContent.includes('View Project')) {
        btn.textContent = this.getTranslation('viewProject');
      }
    });

    viewCodeBtns.forEach(btn => {
      if (btn.textContent.includes('Código') || btn.textContent.includes('Code')) {
        btn.textContent = this.getTranslation('viewCode');
      }
    });

    // Traduzir status de projetos
    const statusElements = document.querySelectorAll('.project-status');
    statusElements.forEach(status => {
      if (status.textContent.includes('Concluído') || status.textContent.includes('Completed')) {
        status.textContent = this.getTranslation('completed');
      }
    });
  }

  getTranslation(key) {
    if (!key) return null;

    const keys = key.split('.');
    let translation = translations[this.currentLang];

    for (const k of keys) {
      if (translation && translation[k] !== undefined) {
        translation = translation[k];
      } else {
        console.warn(`Translation missing for key: ${key} in language: ${this.currentLang}`);
        return null;
      }
    }

    return translation;
  }

  updateLanguageButton() {
    const langToggle = document.querySelector('.lang-toggle');
    const langText = document.querySelector('.lang-text');

    if (langToggle && langText) {
      langText.textContent = this.currentLang === 'pt' ? 'EN' : 'PT';

      const ariaLabel = this.currentLang === 'pt'
        ? this.getTranslation('switchToEnglish')
        : this.getTranslation('switchToPortuguese');
      langToggle.setAttribute('aria-label', ariaLabel);
    }
  }

  updateDocumentLanguage() {
    document.documentElement.lang = this.currentLang === 'pt' ? 'pt-BR' : 'en';
  }

  setupMutationObserver() {
    // Observer para traduzir elementos adicionados dinamicamente
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.type === 'childList') {
          mutation.addedNodes.forEach((node) => {
            if (node.nodeType === Node.ELEMENT_NODE) {
              // Traduzir novos elementos com data-translate
              const elementsToTranslate = node.querySelectorAll ?
                node.querySelectorAll('[data-translate]') : [];
              elementsToTranslate.forEach(element => {
                const key = element.getAttribute('data-translate');
                const translation = this.getTranslation(key);
                if (translation) {
                  if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translation;
                  } else {
                    element.textContent = translation;
                  }
                }
              });
            }
          });
        }
      });
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  }

  getTextNodes(element) {
    const textNodes = [];
    const walker = document.createTreeWalker(
      element,
      NodeFilter.SHOW_TEXT,
      null,
      false
    );

    let node;
    while (node = walker.nextNode()) {
      if (node.textContent.trim()) {
        textNodes.push(node);
      }
    }

    return textNodes;
  }

  // Sistema de observadores para notificar outras partes do código sobre mudanças de idioma
  addObserver(callback) {
    this.observers.push(callback);
  }

  removeObserver(callback) {
    this.observers = this.observers.filter(obs => obs !== callback);
  }

  notifyObservers(lang) {
    this.observers.forEach(callback => callback(lang));
  }

  // Métodos públicos para uso externo
  getCurrentLanguage() {
    return this.currentLang;
  }

  getSupportedLanguages() {
    return [...this.supportedLangs];
  }
}

// Criar instância global
const translator = new TranslationSystem();

// Compatibilidade com código existente
window.translator = translator;
window.translations = translations;

// Exportar para uso em módulos
if (typeof module !== 'undefined' && module.exports) {
  module.exports = { translator, translations };
}
